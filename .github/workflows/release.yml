name: Release

on: { push: { tags: ["v*"] } }


jobs:
  release:
    runs-on: ubuntu-latest
    container: ghcr.io/${{ github.repository_owner }}/kobo-tieng-viet:latest
    steps:
    - name: Install git and make
      run: |
        apt-get update
        apt-get install -y git make

    - name: Checkout
      uses: actions/checkout@v5
      with:
        submodules: true

    - name: Build
      run: make all

    - name: Upload artifact
      uses: actions/upload-artifact@v4
      with:
        name: kobo-tieng-viet
        path: ./dist/KoboRoot.tgz

    - name: Create GitHub Release
      uses: softprops/action-gh-release@v2
      with:
        name: "Kobo Tiáº¿ng Viá»‡t ${{ github.ref_name }}"
        body: |
         ## ðŸ“– Kobo Tiáº¿ng Viá»‡t
         Release cho báº£n **${{ github.ref_name }}**

         - Bao gá»“m file `KoboRoot.tgz`
         - CÃ i Ä‘áº·t báº±ng cÃ¡ch copy vÃ o `.kobo/` cá»§a thiáº¿t bá»‹
        files: ./dist/KoboRoot.tgz
